<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="document-creator">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>

        <product-version-selector product="{{productId}}" version="{{versionId}}">
        </product-version-selector>

        <form is="iron-form" method="post" action="[[constructUrlFrom(productId, versionId)]]">
            <paper-input label="Title" name="Title"></paper-input>
            <paper-input label="Description" name="Description"></paper-input>
            <paper-input label="Language" name="Language"></paper-input>
            <paper-textarea label="Content" name="Content"></paper-textarea>
            <paper-button raised on-tap="submitForm">Submit</paper-button>
        </form>
    </template>

    <script>
    Polymer({
        //TODO : use better MVVM
        is: 'document-creator',
        properties: {
            productId: String,
            versionId: String
        },
        submitForm: function() {
            if (!this.productId || !this.versionId) {
                return;
            }
            document.querySelector('form').submit();
        },
        constructUrlFrom: function(productId, versionId) {
            return "http://myserver/Papyrus.Api/products/" + productId + "/versions/" + versionId + "/documents"
        }
    });
  </script>
</dom-module>