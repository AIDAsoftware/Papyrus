<link rel="import" href="bower_components/polymer/polymer.html">

<link rel="import" href="bower_components/paper-input/paper-input.html">
<link rel="import" href="bower_components/paper-card/paper-card.html">
<link rel="import" href="bower_components/iron-ajax/iron-ajax.html">

<dom-module id="document-listing">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <iron-ajax id="ajax"
          method="GET"
          last-response="{{documents}}"></iron-ajax>
        <template is="dom-repeat"  items="[[documents]]" as="document">
            <paper-card heading="[[document.Title]]">
              <div class="card-content">
                  <p>Description: [[document.Description]]</p>
              </div>
            </paper-card>
        </template>

  </template>
  <script>
    Polymer({
      is: 'document-listing',
      properties: {
          product: {
              type: String,
              notify: true
          },
          version: {
              String,
              notify: true
          },
          documents: Array,
          isVisible: {
              type: Boolean,
              value: false,
              computed: '_checkVisibility(product, version)'
          }
      },
      _checkVisibility: function(product, version) {
          //TODO: Fix this, find a way to show the documents only when version and product are set
          console.log(product != null && version != null);
          this.$.ajax.url = "http://localhost/Papyrus.Api/products/"+ product +"/versions/"+ version +"/documents"
          this.$.ajax.generateRequest();
          return product != null && version != null;
      }
    });
  </script>
</dom-module>